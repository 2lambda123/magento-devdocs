---
group: testing
title: Parameterized Data Fixtures
---

{:.bs-callout-info}
Parameterized Data Fixtures currently only available for Magento Open Source contributors, and will be released for public with Magento Open Source 2.5.5.

## Overview

Parameterized data fixtures is a scalable and flexible way to create a data fixture for integration tests. Such fixtures can accept parameters directly from annotations, like, but not limited to, entity name, status, quantity and so on,
therefore eliminating the need of creating almost identical fixtures every time a slight change is needed.

## Benefits

Parameterized data fixtures allows developers to:

-  Reduce duplicated codes in integration fixture files.
-  Reduce the number of fixture files.
-  Remove fixtures coupling.
-  Write reusable and customizable data fixtures.
-  Focus on test scenarios and not fixtures.
-  Save time in development and code review process.

## Principles

1. Fixture class MUST implement `Magento\TestFramework\Fixture\DataFixtureInterface` or  `Magento\TestFramework\Fixture\RevertibleDataFixtureInterface` if the data created by the fixture is revertible. For instance fixture that creates an entity (e.g. product).
1. Fixture class SHOULD be placed in `<ModuleName>/Test/Fixture` folder of corresponding module with namespace: `<VendorName>\<ModuleName>\Test\Fixture` (e.g. Magento\Catalog\Test\Fixture).
1. Fixture class SHOULD follow single responsibility principle.
1. Fixture alias SHOULD be camelcase.
1. Fixture JSON parameter MUST be a valid JSON string.

## Supply data to parameterized fixture as a variable

It is possible to supply data as a variable from one fixture to another using `$variableName$` in annotation. 

Example 1:

```php?start_inline=1
class QuoteTest extends \PHPUnit\Framework\TestCase
{
    /**
     * @magentoDataFixture \Magento\Catalog\Test\Fixture\Product with:{"sku": "simple1", "price": 5.0} as:product1
     * @magentoDataFixture \Magento\Catalog\Test\Fixture\Product with:{"sku": "simple2", "price": 10.0} as:product2
     * @magentoDataFixture \Magento\Quote\Test\Fixture\GuestCart as:cart
     * @magentoDataFixture \Magento\Quote\Test\Fixture\AddSimpleProductToCart with:{"cart": "$cart$", "product": "$product1$", "qty": 2}
     * @magentoDataFixture \Magento\Quote\Test\Fixture\AddSimpleProductToCart with:{"cart": "$cart$", "product": "$product2$", "qty": 1}
     */
    public function testGetProductsCount(): void
    {
    }
}
```

Example 2:

```php?start_inline=1
class QuoteTest extends \PHPUnit\Framework\TestCase
{
    /**
     * @magentoDataFixture \Magento\Catalog\Test\Fixture\Product with:{"sku": "simple1", "price": 5.0} as:product1
     * @magentoDataFixture \Magento\Catalog\Test\Fixture\Product with:{"sku": "simple2", "price": 10.0} as:product2
     * @magentoDataFixture \Magento\Quote\Test\Fixture\GuestCart as:cart
     * @magentoDataFixture \Magento\Quote\Test\Fixture\AddSimpleProductToCart with:{"cartId": "$cart.id$", "productId": "$product1.id$", "qty": 2}
     * @magentoDataFixture \Magento\Quote\Test\Fixture\AddSimpleProductToCart with:{"cartId": "$cart.id$", "productId": "$product2.id$", "qty": 1}
     */
    public function testGetProductsCount(): void
    {
    }
}
```

## Automatic data generation

The system can automatically generate unique data values like, but not limited to, product names, SKUs, etc.

Example where the Product SKUs are manually provided to the fixture:

```php?start_inline=1
class ProductsList extends \PHPUnit\Framework\TestCase
{
    /**
     * @magentoDataFixture \Magento\Catalog\Fixture\CreateSimpleProduct with:{"sku": "simple1"}
     * @magentoDataFixture \Magento\Catalog\Fixture\CreateSimpleProduct with:{"sku": "simple2"}
     */
    public function testGetProductsCount(): void
    {
    }
}
```

Example where the Product SKUs will be automatically generated by the fixture:

```php?start_inline=1
class ProductsList extends \PHPUnit\Framework\TestCase
{
    /**
     * @magentoDataFixture \Magento\Catalog\Fixture\CreateSimpleProduct
     * @magentoDataFixture \Magento\Catalog\Fixture\CreateSimpleProduct
     */
    public function testGetProductsCount(): void
    {
    }
}
```

## Decoupling fixtures

Fixtures must be written in the way that they only use one API to generate data. For example, the fixture that creates
a product should only call "create product" API and return the product created. This fixture should not add any extra
logic beyond the "create product" API capabilities, such logic should be implemented in a separate fixture and take
advantage of fixtures binding to link fixtures.

### Examples

Example 1:

```php?start_inline=1
class QuoteTest extends \PHPUnit\Framework\TestCase
{

  /**
   * @magentoApiDataFixture Magento\Catalog\Test\Fixture\Product as:product
   * @magentoApiDataFixture Magento\Quote\Test\Fixture\GuestCart as:cart
   * @magentoApiDataFixture Magento\Quote\Test\Fixture\AddProductToCart as:item1
   * @magentoApiDataFixture Magento\Quote\Test\Fixture\SetBillingAddress with:{"cart_id":"$cart.id$"}
   * @magentoApiDataFixture Magento\Quote\Test\Fixture\SetShippingAddress with:{"cart_id":"$cart.id$"}
   * @magentoDataFixtureDataProvider {"item1":{"cart_id":"$cart.id$","product_id":"$product.id$","qty":2}}
   */
   public function testCollectTotals(): void
   {
   }
}
```

Example 2:

```php?start_inline=1
class QuoteTest extends \PHPUnit\Framework\TestCase
{
   /**
   * @magentoApiDataFixture Magento\Customer\Fixture\CreateCustomer as:customer
   * @magentoApiDataFixture Magento\Catalog\Fixture\CreateDropdownAttribute with:{"options":["option_a","option_b"]} as:attr1
   * @magentoApiDataFixture Magento\Catalog\Fixture\CreateDropdownAttribute with:{"options":["option_1","option_2"]} as:attr2
   * @magentoApiDataFixture Magento\Catalog\Fixture\CreateSimpleProduct with:{"sku":"simple1"} as:product1
   * @magentoApiDataFixture Magento\Catalog\Fixture\CreateSimpleProduct with:{"sku":"simple2"} as:product2
   * @magentoApiDataFixture Magento\ConfigurableProduct\Fixture\CreateConfigurableProduct as:configurable
   * @magentoApiDataFixture Magento\Quote\Fixture\CreateEmptyCartForCustomer with:{"customer":"$customer"} as:cart
   * @magentoApiDataFixture Magento\ConfigurableProduct\Fixture\AddConfigurableProductToCart with:{"cart":"$cart","product":"$configurable", "selection":"$product1"}
   * @magentoApiDataFixture Magento\ConfigurableProduct\Fixture\AddConfigurableProductToCart with:{"cart":"$cart","product":"$configurable", "selection":"$product2"}
   * @magentoApiDataFixture Magento\Quote\Fixture\AddShippingAddressToCart with:{"cart":"$cart"}
   */
   public function testCartWithConfigurable()
   {
   }

   public function cartWithConfigurableFixtureDataProvider(): array
   {
      return [
         'configurable' => [
             'attributes' => ['$attr1', '$attr2'],
             'products' => [
                 [
                     'product' => '$product1',
                     'options' => [
                         ['attribute' => '$attr1', 'option' => 'option_a'],
                         ['attribute' => '$attr2', 'option' => 'option_1']
                     ]
                 ],
                 [
                     'product' => '$product2',
                     'options' => [
                         ['attribute' => '$attr1', 'option' => 'option_a'],
                         ['attribute' => '$attr1', 'option' => 'option_2']
                     ]
                 ]
             ]
         ]
      ];
   }
}
```